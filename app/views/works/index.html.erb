<main>
  <h1> List of All Works</h1>

  <section>
    <table>
      <tr class='table-header'>
        <td>UPVOTE</td>
        <td>DOWNVOTE</td>
        <td>POINTS</td>
        <td>CATEGORY</td>
        <td>TITLE</td>
        <td>CREATOR</td>
        <td>PUBLISHED</td>
        <td>EDIT</td>
        <td>DELETE</td>
      </tr>
      <% Work.all_by_votes.each do |work| %>
          <tr>
          <% current_user = User.find_by(id: session[:user_id])%>
          <% if current_user == nil || !current_user.already_voted(work.id) %>
            <td>
              <button type="button" class="btn btn-vote active">
              <%= link_to "↑", work_upvote_path(work.id), method: :post, class: "vote-link" %> <span class="badge"> <%= work.upvote_count %> </span>
              </button>
            </td>
            <td>
              <button type="button" class="btn btn-vote active">
                <%= link_to "↓", work_downvote_path(work.id), method: :post, class: "vote-link" %> <span class="badge"> <%= work.downvote_count %> </span>
              </button>
            </td>
          <% else %>
            <td>
              <button type="button" class="btn btn-vote disabled">
                ↑ <span class="badge"> <%= work.upvote_count %> </span>
              </button>
            </td>
            <td>
              <button type="button" class="btn btn-vote disabled">
                ↓ <span class="badge"> <%= work.downvote_count %> </span>    
              </button>
            </td>      
          <% end %>     
            <td><%= work.vote_count %></td>
            <td><%= work.category %></td>
            <td><%= link_to work.title, work_path(work.id) %></td>
            <td><%= work.creator %></td>
            <td><%= work.publication_year %></td>
            <td><%= link_to "Edit", edit_work_path(work.id), class: "edit-link" %></td>
            <td><%= link_to "Delete", work_path(work.id), method: :delete, data: { confirm: "Are you sure?" }, class: "delete-link" %></td>
          </tr>
      <% end %>
    </table>
  </section>
</main>

