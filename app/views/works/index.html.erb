<main>
  <h2>List of Works</h2>

  <section class="media-table">
    <% titles_array = ["Albums", "Books", "Movies"] %>
    <% titles_array.each do |title| %>
      <h4><%= title %></h4>
      <table class="table">
        <thead>
          <tr>
            <th width="80">Votes</th>
            <th>Title</th>
            <th>Created By</th>
            <th width="100">Published</th>
            <th width="100">Upvote</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <% works_array = [:album, :book, :movie] %>
            <% works_array.each do |category|%>
              <% works = Work.where(category: category)%>
                <% works.each do |work| %>
                <tr>
                  <td>
                    <%= work.votes.length %>
                  </td>
                  <td>
                    <%= link_to work.title, work_path(id: work.id) %> 
                  </td>
                  <td>
                    <%= work.creator %>
                  </td>
                  <td>
                    <%= work.publication_year %>
                  </td>
                  <td>
                    <%= link_to "Upvote", work_votes_path(work.id), method: :post, class:"btn btn-primary" %>
                  </td>
                <% end %>
            <% end %>
          </tr>
        </tbody>
      </table>
    <% end %>
  </section>

  <a class="btn btn-secondary" href="/">View top media</a>
  <a class="btn btn-primary" href="/works/new">Add a new work</a>
</main>